<script>
    const socket = io();
    let username = "";
    let room = "";

    function joinRoom() {
        username = document.getElementById('usernameInput').value.trim();
        room = document.getElementById('roomInput').value.trim();
        if (username && room) {
            socket.emit('join', { username, room });
            document.getElementById('joinBox').style.display = 'none';
            document.getElementById('chat').style.display = 'block';
            document.getElementById('messageBox').style.display = 'flex';
            document.getElementById('roomTitle').innerText = `Room: ${room}`;
        }
    }

    function sendMessage() {
        const input = document.getElementById('messageInput');
        const message = input.value.trim();
        if (message) {
            socket.emit('send_message', { message });
            input.value = '';
        }
    }

    // **New code: send on Enter**
    const messageInput = document.getElementById('messageInput');
    messageInput.addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            event.preventDefault(); // prevent new line
            sendMessage();
        }
    });

    socket.on('receive_message', function(data) {
        const messages = document.getElementById('messages');
        const item = document.createElement('li');
        item.textContent = data.message;
        messages.appendChild(item);
        messages.scrollTop = messages.scrollHeight; // auto-scroll to latest
    });
</script>
